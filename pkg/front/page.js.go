// GENERATED BY textFileToGoConst
// GitHub:     github.com/logrusorgru/textFileToGoConst
// input file: ..\..\pkg\front\page.js
// generated:  Mon Aug  1 16:32:51 CEST 2022

package front

const PageJs = "getWallets();\r\ngetWebsiteDeployerSC();\r\n\r\nlet wallets = [];\r\nlet deployers = [];\r\n\r\n// open file upload\r\nfunction openDialog(count) {\r\n\tconsole.log(count);\r\n\tdocument.getElementById('fileid0').value = null;\r\n\tdocument.getElementById('fileid0').click();\r\n}\r\n\r\n// Handle event on file selecting\r\nfunction handleFileSelect(evt) {\r\n\tlet files = evt.target.files; // get files\r\n\tlet f = files[0];\r\n\tconst reader = new FileReader();\r\n\treader.onload = (event) => importWallet(JSON.parse(event.target.result)); // desired file content\r\n\treader.onerror = (error) => reject(error);\r\n\treader.readAsText(f);\r\n}\r\n\r\nfunction errorAlert(error) {\r\n\tdocument.getElementsByClassName('alert-danger')[0].style.display = 'block';\r\n\r\n\tdocument.getElementsByClassName('alert-danger')[0].innerHTML = error;\r\n\r\n\tsetTimeout(function () {\r\n\t\tdocument.getElementsByClassName('alert-danger')[0].style.display = 'none';\r\n\t}, 5000);\r\n}\r\n\r\nfunction successDeployWebsite(operationId) {\r\n\tconsole.log(operationId);\r\n\tdocument.getElementsByClassName('alert-primary')[0].style.display = 'block';\r\n\r\n\tdocument.getElementsByClassName('alert-primary')[0].innerHTML =\r\n\t\t'Contract deployed with operation ID : ' + operationId;\r\n\r\n\tsetTimeout(function () {\r\n\t\tdocument.getElementsByClassName('alert-primary')[0].style.display = 'none';\r\n\t}, 5000);\r\n}\r\n// Import a wallet through PUT query\r\nasync function feedSelectOption(w) {\r\n\tconst formSelect = document.getElementsByClassName('form-select');\r\n\tfor (let i = 0; i < w.length; i++) {\r\n\t\tconst opt = document.createElement('option');\r\n\t\topt.value = i;\r\n\t\topt.text = w[i].nickname;\r\n\t\tformSelect[0].append(opt);\r\n\t}\r\n}\r\n\r\n// Create a wallet through POST query\r\nasync function getWallets() {\r\n\taxios\r\n\t\t.get('/mgmt/wallet')\r\n\t\t.then((resp) => {\r\n\t\t\tif (resp) {\r\n\t\t\t\tconst data = resp.data;\r\n\t\t\t\twallets = data;\r\n\t\t\t\tfeedSelectOption(wallets);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch((e) => {\r\n\t\t\terrorAlert(e);\r\n\t\t});\r\n}\r\n\r\nasync function getWebsiteDeployerSC() {\r\n\taxios\r\n\t\t.get('/uploadWeb')\r\n\t\t.then((websites) => {\r\n\t\t\tlet count = 0;\r\n\t\t\tfor (const website of websites.data) {\r\n\t\t\t\ttableInsert(website, count);\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t\tdeployers = websites.data;\r\n\t\t})\r\n\t\t.catch((e) => {\r\n\t\t\terrorAlert(e.response.data.code);\r\n\t\t});\r\n}\r\n\r\nasync function deployWebsiteDeployerSC() {\r\n\taxios\r\n\t\t.post('/uploadWeb')\r\n\t\t.then((operation) => {\r\n\t\t\tsuccessDeployWebsite(operation.data);\r\n\t\t})\r\n\t\t.catch((e) => {\r\n\t\t\terrorAlert(e.response.data.code);\r\n\t\t});\r\n}\r\n\r\nfunction tableInsert(resp, count) {\r\n\tconst tBody = document.getElementById('website-deployers-table').getElementsByTagName('tbody')[0];\r\n\tconst row = tBody.insertRow(-1);\r\n\r\n\tconst cell0 = row.insertCell();\r\n\tconst cell1 = row.insertCell();\r\n\tconst cell2 = row.insertCell();\r\n\r\n\tcell0.innerHTML = 'Name';\r\n\tcell1.innerHTML = resp;\r\n\tcell2.innerHTML =\r\n\t\t\"<div><input id='fileid\" +\r\n\t\tcount +\r\n\t\t\"' type='file' hidden/><button id='updload-website\" +\r\n\t\tcount +\r\n\t\t\"'\" +\r\n\t\t\"class='primary-button' id='buttonid' type='button' value='Upload MB' >Upload</button></div>\";\r\n\r\n\tdocument.getElementById(`updload-website${count}`).addEventListener('click', function () {\r\n\t\tdocument.getElementById(`fileid${count}`).value = null;\r\n\t\tdocument.getElementById(`fileid${count}`).click();\r\n\t});\r\n\r\n\tdocument.getElementById(`fileid${count}`).addEventListener('change', function (evt) {\r\n\t\tlet files = evt.target.files; // get files\r\n\t\tconsole.log(evt.target.files);\r\n\t\tlet f = files[0];\r\n\t\tconst reader = new FileReader();\r\n\r\n\t\treader.onload = (event) => uploadWebsite(event.target.result, count); // desired file content\r\n\t\treader.onerror = (error) => reject(error);\r\n\t\treader.readAsText(f);\r\n\t});\r\n\r\n\tfunction uploadWebsite(file, count) {\r\n\t\taxios\r\n\t\t\t.put(`/uploadWeb/${deployers[count]}`, file)\r\n\t\t\t.then((operation) => {\r\n\t\t\t\tconsole.log('OK');\r\n\t\t\t})\r\n\t\t\t.catch((e) => {\r\n\t\t\t\terrorAlert(e.response.data.code);\r\n\t\t\t});\r\n\t}\r\n}\r\n"
